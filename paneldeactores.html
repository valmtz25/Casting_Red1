<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Panel de Actores - Castingred</title>
<style>
body {
  font-family: 'Poppins', sans-serif;
  background: linear-gradient(135deg, #74ebd5, #ACB6E5);
  padding: 40px 20px;
  min-height: 100vh;
}
h2 {
  text-align: center;
  color: #fff;
  font-size: 3rem;
  font-weight: 800;
  text-shadow: 2px 2px 10px rgba(0,0,0,0.3);
  margin-bottom: 30px;
}
#listas {
  display: flex;
  flex-direction: column;
  gap: 40px;
}
.lista-container {
  background: rgba(255,255,255,0.85);
  padding: 20px;
  border-radius: 20px;
}
.lista-container h3 {
  margin-bottom: 15px;
  color: #333;
}
.lista {
  display: flex;
  flex-wrap: wrap;
  gap: 20px;
}
.perfil {
  background: #fff;
  padding: 15px;
  border-radius: 15px;
  width: 220px;
  border-left: 6px solid #1a73e8;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}
.perfil img {
  width: 100%;
  border-radius: 12px;
  margin-bottom: 10px;
  object-fit: cover;
  height: 220px;
}
.perfil h4 { margin: 5px 0; font-size: 1.2rem; color: #333; }
.perfil p { margin: 3px 0; font-size: 0.9rem; color: #555; }
.perfil a { color: #1a73e8; text-decoration: none; }
.perfil button {
  width: 100%;
  margin-top: 5px;
  padding: 6px;
  border-radius: 10px;
  border: none;
  cursor: pointer;
  font-size: 0.9rem;
  transition: 0.3s;
}
.perfil button.aprobar { background-color: #4caf50; color:white; }
.perfil button.rechazar { background-color: #f44336; color:white; }
.perfil button.eliminar { background-color: #607d8b; color:white; }
.perfil button:hover { opacity: 0.85; }
#cerrarSesion {
  display:block;
  margin: 0 auto 30px auto;
  padding: 10px 20px;
  background:#ff5a36;
  color:white;
  border:none;
  border-radius:12px;
  cursor:pointer;
  font-size:1rem;
  transition:0.3s;
}
#cerrarSesion:hover { background:#ff7e5f; }
</style>
</head>
<body>

<h2>ðŸŽ¬ Panel de Actores</h2>
<button id="cerrarSesion">Cerrar sesiÃ³n</button>

<div id="listas">
  <div class="lista-container">
    <h3>Pendientes</h3>
    <div id="pendientes" class="lista"></div>
  </div>
  <div class="lista-container">
    <h3>Aprobados</h3>
    <div id="aprobados" class="lista"></div>
  </div>
  <div class="lista-container">
    <h3>Rechazados</h3>
    <div id="rechazados" class="lista"></div>
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-app.js";
import { getFirestore, collection, onSnapshot, doc, updateDoc, deleteDoc } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-firestore.js";
import { getAuth, signOut } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-auth.js";

// Config Firebase
const firebaseConfig = {
  apiKey: "AIzaSyBQmYwkqr29lvaF8ew3BJ2suc5UxRaVU1Y",
  authDomain: "castingred-a6f6e.firebaseapp.com",
  projectId: "castingred-a6f6e",
  storageBucket: "castingred-a6f6e.appspot.com",
  messagingSenderId: "61701399093",
  appId: "1:61701399093:web:678b77ff06ce83e1a1077c",
  measurementId: "G-J1QPG9HXGZ"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const auth = getAuth(app);

const pendientesDiv = document.getElementById("pendientes");
const aprobadosDiv = document.getElementById("aprobados");
const rechazadosDiv = document.getElementById("rechazados");

function crearTarjeta(actor, id) {
  const div = document.createElement("div");
  div.className = "perfil";
  div.innerHTML = `
    <img src="${actor.foto}" alt="${actor.nombreCompleto}">
    <h4>${actor.nombreCompleto}</h4>
    <p>Edad: ${actor.edad}</p>
    <p>GÃ©nero: ${actor.genero}</p>
    <p>Tel: ${actor.telefono}</p>
    <p>Correo: ${actor.correo}</p>
    <p>Experiencia: ${actor.experiencia || '-'}</p>
    <p>Rol: ${actor.rolPreferido || '-'}</p>
    <p>Portafolio: ${actor.portafolioDigital ? `<a href="${actor.portafolioDigital}" target="_blank">Ver</a>` : '-'}</p>
    <button class="aprobar">Aprobar</button>
    <button class="rechazar">Rechazar</button>
    <button class="eliminar">Eliminar</button>
  `;

  // Botones
  div.querySelector(".aprobar").addEventListener("click", async ()=>{
    await updateDoc(doc(db, "actores", id), { estado: "aprobados" });
  });
  div.querySelector(".rechazar").addEventListener("click", async ()=>{
    await updateDoc(doc(db, "actores", id), { estado: "rechazados" });
  });
  div.querySelector(".eliminar").addEventListener("click", async ()=>{
    if(confirm("Â¿Eliminar actor?")){
      await deleteDoc(doc(db, "actores", id));
    }
  });

  return div;
}

// Escucha en tiempo real
onSnapshot(collection(db, "actores"), snapshot=>{
  pendientesDiv.innerHTML = "";
  aprobadosDiv.innerHTML = "";
  rechazadosDiv.innerHTML = "";

  snapshot.forEach(docSnap=>{
    const actor = docSnap.data();
    const tarjeta = crearTarjeta(actor, docSnap.id);

    if(actor.estado === "pendientes") pendientesDiv.appendChild(tarjeta);
    else if(actor.estado === "aprobados") aprobadosDiv.appendChild(tarjeta);
    else if(actor.estado === "rechazados") rechazadosDiv.appendChild(tarjeta);
  });
});

// Cerrar sesiÃ³n
document.getElementById("cerrarSesion").addEventListener("click", ()=>{
  signOut(auth).then(()=>window.location.href="login.html");
});
</script>

</body>
</html>
